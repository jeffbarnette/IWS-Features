{% extends "features/base.html" %}
{% block content %}

  <h2>{{ feature.title }}</h2>
  {% if feature.create_date %}
    <strong>Requested:</strong> {{ feature.create_date|date:"D M Y" }} by {{ feature.author }}<br />
    <strong>Target Delivery Date:</strong> {{ feature.target_date|date:"D M Y" }}<br /><br />
  {% else %}
    <a class="btn btn-outline-primary" href="{% url 'feature_publish' pk=feature.pk %}">Publish</a>
  {% endif %}
  <strong>Description:</strong>
  <p>{{ feature.description|safe|linebreaksbr }}</p>

  <strong>Client:</strong> {{ feature.client }}<br />
  <strong>Priority:</strong> {{ feature.client_priority }}<br /><br />

  {% if user.is_authenticated %}
    <a class="btn btn-outline-primary" href="{% url 'feature_edit' pk=feature.pk %}">
      Edit
    </a>
    <a class="btn btn-outline-danger" href="{% url 'feature_remove' pk=feature.pk %}">
      Remove
    </a>
  {% endif %}

  <hr>
  {% if user.is_authenticated %}
    <a class="btn btn-outline-primary float-right" href="{% url 'add_comment_to_feature' pk=feature.pk %}">Add Comment</a>
  {% endif %}
  <div class="container">
    {% for comment in feature.comments.all %}
    <br>
      {% if user.is_authenticated or comment.approved_comment %}
        {{ comment.create_date }}
          {% if not comment.approved_comment %}
            <a class="btn btn-default" href="{% url 'comment_remove' pk=comment.pk %}">
              Remove
            </a>
            <a class="btn btn-default" href="{% url 'comment_approve' pk=comment.pk %}">
              Approve
            </a>
          {% endif %}

          <p>{{comment.text|safe|linebreaks}}</p>
          <small>Added by: {{comment.author}}</small>
          <hr>

      {% endif %}
      {% empty %}
      <p>No Comments</p>
    {% endfor %}
  </div>
{% endblock %}
